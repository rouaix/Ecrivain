<h2>Réinitialiser le mot de passe</h2>

<check if="!empty(@errors)">

    <div class="error">

        <ul>

            <repeat group="@errors" value="@err">

                <li>{{ @err }}</li>

            </repeat>

        </ul>

    </div>

</check>

<check if="@invalidToken">

    <p class="info">Le lien de réinitialisation est invalide ou a expiré. <a href="{{ @base }}/password/forgot">Demander

            un nouveau lien</a>.</p>

</check>

<check if="!@invalidToken">

    <form class="login" method="post" action="{{ @base }}/password/reset/{{ @token }}">

        <input type="hidden" name="csrf_token" value="{{ @csrfToken }}">

        <div class="form-group">

            <label for="password">Nouveau mot de passe</label>

            <input type="password" id="password" name="password" required>

        </div>

        <div class="form-group">

            <label for="password_confirmation">Confirmez le mot de passe</label>

            <input type="password" id="password_confirmation" name="password_confirmation" required>

        </div>

        <input type="submit" value="Mettre à jour le mot de passe">

    </form>

</check>

<p><a href="{{ @base }}/login">Retour à la connexion</a></p>

<script nonce="{{ @nonce }}">

    document.addEventListener('DOMContentLoaded', () => {

        ['password', 'password_confirmation'].forEach((id) => {

            const input = document.getElementById(id);

            if (!input) {

                return;

            }

            input.addEventListener('keydown', (event) => {

                if (event.key === ' ') {

                    event.preventDefault();

                }

            });

            input.addEventListener('input', () => {

                const cleaned = input.value.replace(/\s+/g, '');

                if (input.value !== cleaned) {

                    const cursorPosition = input.selectionStart ?? 0;

                    const removed = input.value.length - cleaned.length;

                    input.value = cleaned;

                    const newPosition = Math.max(cursorPosition - removed, 0);

                    input.setSelectionRange(newPosition, newPosition);

                }

            });

        });

    });

</script>